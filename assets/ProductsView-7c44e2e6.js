import{M as P}from"./modal-33ece1fc.js";import{_ as b,o as i,c as l,a as t,t as o,e as $,v as M,F as p,f as v,r as u,b as h,n as C,w as x,d as g,g as I}from"./index-7ca8e986.js";const V={props:["product"],data(){return{modal:"",qty:1}},methods:{showModal(){this.qty=1,this.modal.show()},hideModal(){this.modal.hide()},addCart(){this.$emit("addCart",this.product.id,this.qty)}},mounted(){this.modal=new P(this.$refs.modal,{keyboard:!1})}},w={class:"modal fade",id:"UserProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},L={class:"modal-dialog modal-xl",role:"document"},A={class:"modal-content border-0"},E={class:"modal-header bg-dark text-white"},U={class:"modal-title",id:"exampleModalLabel"},T=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),q={class:"modal-body"},D={class:"row"},B={class:"col-sm-6"},N=["src","alt"],S={class:"col-sm-6"},z={class:"badge bg-primary rounded-pill"},F={key:0,class:"h5"},H={key:1},O={class:"h6"},R={class:"h5"},j={class:"input-group"},G=["value"];function J(d,a,e,f,c,r){return i(),l("div",w,[t("div",L,[t("div",A,[t("div",E,[t("h5",U,[t("span",null,o(e.product.title),1)]),T]),t("div",q,[t("div",D,[t("div",B,[t("img",{class:"img-fluid",src:e.product.imagesUrl,alt:e.product.title},null,8,N)]),t("div",S,[t("span",z,o(e.product.category),1),t("p",null,"商品描述："+o(e.product.description),1),t("p",null,"商品內容："+o(e.product.content),1),e.product.price==e.product.origin_price?(i(),l("div",F,o(e.product.origin_price)+" 元",1)):(i(),l("div",H,[t("del",O,"原價 "+o(e.product.origin_price)+" 元",1),t("div",R,"現在只要 "+o(e.product.price)+" 元",1)])),t("div",null,[t("div",j,[$(t("select",{class:"form-select","onUpdate:modelValue":a[0]||(a[0]=n=>c.qty=n)},[(i(),l(p,null,v(20,n=>t("option",{value:n,key:`${n}_qty`},o(n),9,G)),64))],512),[[M,c.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:a[1]||(a[1]=(...n)=>r.addCart&&r.addCart(...n))},"加入購物車")])])])])])])])],512)}const K=b(V,[["render",J]]),{VITE_API:_,VITE_APIPATH:m}={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"vue-hexschool-product-list",BASE_URL:"/w6-vue-router/",MODE:"production",DEV:!1,PROD:!0},Q={data(){return{products:[],product:{},loadingItem:"",isLoading:!1}},methods:{getProducts(){this.isLoading=!0,this.$http.get(`${_}/api/${m}/products`).then(d=>{this.products=d.data.products,this.isLoading=!1}).catch(d=>{alert(d.response.data.message),this.isLoading=!1})},getProduct(d){this.loadingItem=d,this.$http.get(`${_}/api/${m}/product/${d}`).then(a=>{this.product=a.data.product,this.$refs.userProductModal.showModal(),this.loadingItem=""}).catch(a=>{alert(a.response.data.message)})},addCart(d,a=1){this.loadingItem=d,this.$http.post(`${_}/api/${m}/cart`,{data:{product_id:d,qty:a}}).then(e=>{this.$refs.userProductModal.hideModal(),alert(e.data.message),this.loadingItem=""}).catch(e=>{alert(e.response.data.message)})}},components:{UserProductModal:K},mounted(){this.getProducts()}},W={class:"container"},X={class:"mt-4"},Y={class:"table align-middle"},Z=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),tt={style:{width:"200px"}},et={key:0,class:"h5"},st={key:1},ot={class:"h6"},dt={class:"h5"},at={class:"btn-group btn-group-sm"},it=["onClick","disabled"],lt={key:0,class:"fas fa-spinner fa-pulse"};function nt(d,a,e,f,c,r){const n=u("VueLoading"),y=u("UserProductModal"),k=u("router-link");return i(),l(p,null,[h(n,{active:c.isLoading},null,8,["active"]),t("div",W,[t("div",X,[h(y,{ref:"userProductModal",product:c.product,onAddCart:r.addCart},null,8,["product","onAddCart"]),t("table",Y,[Z,t("tbody",null,[(i(!0),l(p,null,v(c.products,s=>(i(),l("tr",{key:s.id},[t("td",tt,[t("div",{style:C([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${s.imageUrl})`}])},null,4)]),t("td",null,o(s.title),1),t("td",null,[s.price===s.origin_price?(i(),l("div",et,o(s.origin_price)+" 元",1)):(i(),l("div",st,[t("del",ot,"原價 "+o(s.origin_price)+" 元",1),t("div",dt,"現在只要 "+o(s.price)+" 元",1)]))]),t("td",null,[t("div",at,[h(k,{class:"btn btn-outline-secondary",to:`/product/${s.id}`},{default:x(()=>[g("查看更多")]),_:2},1032,["to"]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:ct=>r.addCart(s.id),disabled:s.id===c.loadingItem},[s.id===c.loadingItem?(i(),l("i",lt)):I("",!0),g(" 加到購物車 ")],8,it)])])]))),128))])])])])],64)}const ht=b(Q,[["render",nt]]);export{ht as default};
